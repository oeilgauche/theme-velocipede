"use strict";var exec=require("child_process").exec;module.exports=function(e){var r=/(\d\.\d+\.\d+)-pre/;e.registerTask("release","Release a version of sizzle, updates a pre version to released, inserts `next` as the new pre version",function(s){if(!r.test(s))return e.fatal("Next version should be a -pre version (x.x.x-pre): "+s),void 0;var i,t=e.config("pkg.version");return r.test(t)?(t=t.replace(r,"$1"),i=this.async(),exec("git diff --quiet HEAD",function(r){return r?(e.fatal("The working directory should be clean when releasing. Commit or stash changes."),void 0):(e.task.run(["version:"+t,"tag:"+t,"version:"+s]),i(),void 0)}),void 0):(e.fatal("Existing version is not a pre version: "+t),void 0)})};